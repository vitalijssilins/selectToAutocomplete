(function(e){var b={sort:false,"sort-attr":"data-priority","sort-desc":false,autoselect:true,"free-insert":false,"default-renderer":'<a><div class="flag-img"><img src="{flag}" /></div><p class="country-name">{name}</p><p class="country-code">+{code}</p><p class="country-price">{currency} {price}</p></a><div style="clear:both"></div>',"input-additional-attr":"",contacts:false,"contacts-attr":"data-contact","contacts-renderer":"","contacts-category-attr":"data-category","contacts-category-default":"",flags:false,"flags-attr":"data-flag","flags-dir":"./flags/","flags-default":"LV.png","flags-image-selector":"#flag",code:false,"code-show":false,"code-attr":"data-code","code-default":"371","code-selector":"#code",price:false,"price-attr":"data-price","price-default":"0","price-currency":"&euro;","alternative-spellings":true,"alternative-spellings-attr":"data-alternative-spellings","remove-valueless-options":true,"copy-attributes-to-text-field":true,"autocomplete-plugin":"jquery_ui","relevancy-sorting":true,"relevancy-sorting-partial-match-value":2,"relevancy-sorting-strict-match-value":8,"relevancy-sorting-booster-attr":"data-relevancy-booster",handle_invalid_input:function(f){if(!b["free-insert"]){f.$text_field.val(f.$select_field.find("option:selected:first").val())}},handle_select_field:function(f){return f.hide()},insert_text_field:function(l){var g=e("<input></input>");if(b["copy-attributes-to-text-field"]){var h={};var f=l.$select_field[0].attributes;for(var k=0;k<f.length;k++){var j=f[k].nodeName;var m=f[k].nodeValue;if(j!=="name"&&j!=="id"&&typeof l.$select_field.attr(j)!=="undefined"){h[j]=m}}g.attr(h)}g.blur(function(){var i=l.$select_field.find("option").map(function(n,o){return e(o).val()});if(!(g.val() in i)&&typeof b.handle_invalid_input==="function"){b.handle_invalid_input(l)}});if(l.settings.autoselect){g.click(function(){this.select()})}return g.val(l.$select_field.find("option:selected:first").val()).css({display:"inline-block"}).insertAfter(l.$select_field)},extract_options:function(g){var i=[];var f=g.find("option");var h=f.length;f.each(function(){var j=e(this);var n={"real-value":j.attr("value"),label:j.val(),text:j.text()};if(b["remove-valueless-options"]&&n["real-value"]===""){}else{if(b.flags){n.flag=n["flags-default"];var r=j.attr(b["flags-attr"]);if(r){n.flag=r}}if(b.code){n.code=b["code-default"];var k=j.attr(b["code-attr"]);if(k){n.code=k}}if(b.price){n.price=b["price-default"];var o=j.attr(b["price-attr"]);if(o){n.price=o}}n.matches="";var l=j.attr(b["alternative-spellings-attr"]);if(l){n.matches+=l;if(k){n.matches+=" 00"+k+" +"+k+" "+k}}if(b.sort){var m=parseInt(j.attr(b["sort-attr"]),10);if(m){n.weight=m}else{n.weight=h}}if(b.contacts){var p=j.attr(b["contacts-attr"]);if(p){n.contact=p}else{n.contact=p}var s=j.attr(b["contacts-category-attr"]);if(s){n.category=s}else{n.category=b["contacts-category-default"]}}if(b["relevancy-sorting"]){n["relevancy-score"]=0;n["relevancy-score-booster"]=1;var q=parseFloat(j.attr(b["relevancy-sorting-booster-attr"]));if(q){n["relevancy-score-booster"]=q}}i.push(n)}});if(b.sort){if(b["sort-desc"]){i.sort(function(k,j){return j.weight-k.weight})}else{i.sort(function(k,j){return k.weight-j.weight})}}return i},source:function(g,f){},select:function(f,g){}};var d={init:function(f){if(e.browser.msie&&parseInt(e.browser.version,10)<=6){return this}else{b=e.extend({},b,f);return this.each(function(){var g=e(this);var h={"$select_field":g,options:b.extract_options(g),settings:b};h["$text_field"]=b.insert_text_field(h);b.handle_select_field(g);if(typeof b["autocomplete-plugin"]==="string"){c[b["autocomplete-plugin"]](h)}else{b["autocomplete-plugin"](h)}})}}};var c={jquery_ui:function(h){var k=function(n){var o=n.split(" ");var l=[];for(var m=0;m<o.length;m++){if(o[m].length>0){var p={};p.partial=new RegExp(e.ui.autocomplete.escapeRegex(o[m]),"i");if(h.settings["relevancy-sorting"]){p.strict=new RegExp("^"+e.ui.autocomplete.escapeRegex(o[m])+"$","i")}l.push(p)}}return e.grep(h.options,function(w){var r=0;if(h.settings["relevancy-sorting"]){var t=false;var v=w.matches.split(" ")}for(var u=0;u<l.length;u++){if(l[u]["partial"].test(w.matches)){r++}if(h.settings["relevancy-sorting"]){for(var x=0;x<v.length;x++){if(l[u]["strict"].test(v[x])){t=true;break}}}}if(h.settings["relevancy-sorting"]){var s=0;s+=r*h.settings["relevancy-sorting-partial-match-value"];if(t){s+=h.settings["relevancy-sorting-strict-match-value"]}s=s*w["relevancy-score-booster"];w["relevancy-score"]=s}if(h.settings.contacts){if(w.contact){contact=true}else{contact=false}}else{contact=false}return((!n&&!contact)||((l.length===r)&&n))})};var i=function(l){var o;do{o=false;for(var n=0;n<l.length-1;n++){if(l[n]["relevancy-score"]<l[n+1]["relevancy-score"]){var m=l[n];l[n]=l[n+1];l[n+1]=m;o=true}}}while(o);return l};var j=function(l){if(h.settings.flags&&(typeof(l)!=="undefined")){e(h.settings["flags-image-selector"]).attr("src",h.settings["flags-dir"]+l.flag)}else{e(h.settings["flags-image-selector"]).attr("src",h.settings["flags-dir"]+h.settings["flags-default"])}};var f=function(m){if(m){if(h.$select_field.val()!==m["real-value"]){h.$select_field.val(m["real-value"]);j(m);if(h.settings.code&&h.settings["code-show"]){if(m.code){e(h.settings["code-selector"]).val(m.code)}else{e(h.settings["code-selector"]).val(h.settings["code-default"])}}h.$select_field.change()}}else{var n=h.$text_field.val().toLowerCase();var o={"real-value":false};for(var l=0;l<h.options.length;l++){if(n===h.options[l]["label"].toLowerCase()){o=h.options[l];break}}if(h.$select_field.val()!==o["real-value"]){h.$select_field.val(o["real-value"]||"");h.$select_field.change()}if(o["real-value"]){h.$text_field.val(o.label)}if(typeof h.settings.handle_invalid_input==="function"&&h.$select_field.val()===""){h.settings.handle_invalid_input(h)}}};var g=false;h.$text_field.autocomplete({minLength:0,delay:0,autoFocus:true,position:{my:"left+150 top",at:"left bottom"},source:function(o,m){var p=k(o.term);if(h.settings["relevancy-sorting"]){p=i(p)}m(p);if(typeof(p[0])=="undefined"&&o.term){for(var l=1;l<6;l++){var n=k(o.term.substring(0,l));if(typeof(n[0])!="undefined"){p=i(n)}}}if(o.term){j(p[0])}h.settings.source(o,p)},select:function(l,m){f(m.item);var n=[m.item];j(n[0]);h.settings.select(l,m)},open:function(l,m){g=true},close:function(l,m){g=false},change:function(l,m){f(m.item)},search:function(l,m){}}).data("autocomplete")._renderItem=function(m,n){var o=[["name",n.text],["code",n.code],["val",n.label],["price",n.price],["avatar",n.contact],["category",n.category],["currency",h.settings["price-currency"]],["flag",h.settings["flags-dir"]+n.flag],];if(h.settings.contacts&&(h.settings["contacts-renderer"].length>0)&&n.contact){var l=a(h.settings["contacts-renderer"],o)}else{var l=a(h.settings["default-renderer"],o)}return e("<li>").data("item.autocomplete",n).append(l).appendTo(m)};h.$text_field.parents("form:first").submit(function(){f()});f();if(h.settings.flags){e(h.settings["flags-image-selector"]).click(function(){if(g){h.$text_field.autocomplete("close")}else{h.$text_field.autocomplete("search","")}})}}};function a(m,h){var n=null;n=m.split("");var f=[];while(n.length){var l=n[0];if(l=="{"){n.shift();var k=[];do{var g=n.shift();k.push(g);var l=n[0]}while(l!="}");n.shift();k=k.join("");for(var j=0;j<h.length;j++){if(h[j][0]==k){k=h[j][1]}}f.push(k)}else{f.push(n.shift())}}return f.join("")}e.fn.selectToAutocomplete=function(f){if(d[f]){return d[f].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof f==="object"||!f){return d.init.apply(this,arguments)}else{e.error("Method "+f+" does not exist on jQuery.fn.selectToAutocomplete")}}}})(jQuery);